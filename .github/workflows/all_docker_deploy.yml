name: Build and deliver all docker containers

on: 
  workflow_run:
    workflows: ["Build and test all APIs"]
    branches: [main]
    types: 
      - completed

jobs:
  instument-deploy:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    name: Instument Deploy Docker
    uses: JohanTorfs/instrument_edge_api/.github/workflows/reusable_docker_deploy.yml@main
    with:
      container-name: instrument_instrument_api
      root-path: ./instrument_api
  piece-deploy:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    name: Piece Deploy Docker
    uses: JohanTorfs/instrument_edge_api/.github/workflows/reusable_docker_deploy.yml@main
    with:
      container-name: instrument_piece_api
      root-path: ./piece_api
  review-deploy:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    name: Review Deploy Docker
    uses: JohanTorfs/instrument_edge_api/.github/workflows/reusable_docker_deploy.yml@main
    with:
      container-name: instrument_review_api
      root-path: ./review_api
