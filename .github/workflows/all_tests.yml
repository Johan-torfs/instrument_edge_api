name: Build and test all APIs

on: 
  pull_request:
    branches:
      - 'dev'
  push:
    branches:
      - 'main'

jobs:
  all-tests:
    name: All API Tests
    strategy:
      matrix:
        api-name: [instrument_api, piece_api, review_api]
        database: [sql, mongo, mongo]
        database-port: [3306, 27017, 27018]
    uses: JohanTorfs/instrument_edge_api/.github/workflows/reusable_tests.yml@main
    with:
      api-name: ${{ matrix.api-name }}
      database: ${{ matrix.database }}
      database-port: ${{ matrix.database-port }}
